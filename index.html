<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pembukuan Harian & Mingguan</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
  input, select, button { margin: 5px 0; padding: 5px; width: 100%; }
  table { width: 100%; margin-top: 15px; border-collapse: collapse; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  h2, h3 { margin-top: 20px; }
</style>
</head>
<body>
<h2>Pembukuan Harian & Tabungan Mingguan</h2>

<label>Tanggal:</label>
<input type="date" id="tanggal"><br>

<label>Jenis:</label>
<select id="jenis">
  <option value="pemasukan">Pemasukan</option>
  <option value="pengeluaran">Pengeluaran</option>
</select><br>

<label>Kategori:</label>
<input type="text" id="kategori" placeholder="Makan, Transport, dll"><br>

<label>Nominal:</label>
<input type="number" id="nominal" placeholder="Masukkan nominal"><br>

<label>Persentase Tabungan (%):</label>
<input type="number" id="persentase" value="20" min="0" max="100"><br>

<button onclick="tambahTransaksi()">Tambah Transaksi</button>

<h3>Ringkasan Harian</h3>
<p>Total Pemasukan: Rp <span id="totalPemasukan">0</span></p>
<p>Total Pengeluaran: Rp <span id="totalPengeluaran">0</span></p>
<p>Saldo Hari Ini: Rp <span id="saldo">0</span></p>
<p>Tabungan (persentase): Rp <span id="modal">0</span></p>

<h3>Riwayat Transaksi Harian</h3>
<table>
  <thead>
    <tr>
      <th>Tanggal</th>
      <th>Jenis</th>
      <th>Kategori</th>
      <th>Nominal</th>
    </tr>
  </thead>
  <tbody id="riwayat">
  </tbody>
</table>

<h3>Rekap Mingguan</h3>
<table>
  <thead>
    <tr>
      <th>Minggu Mulai</th>
      <th>Total Pemasukan</th>
      <th>Total Pengeluaran</th>
      <th>Saldo</th>
      <th>Tabungan</th>
    </tr>
  </thead>
  <tbody id="rekapMingguan">
  </tbody>
</table>

<script>
let transaksi = [];

function tambahTransaksi() {
  const tanggal = document.getElementById('tanggal').value;
  const jenis = document.getElementById('jenis').value;
  const kategori = document.getElementById('kategori').value || '-';
  const nominal = parseInt(document.getElementById('nominal').value);
  const persentase = parseFloat(document.getElementById('persentase').value) / 100;

  if (!tanggal) { alert('Masukkan tanggal!'); return; }
  if (!nominal) { alert('Masukkan nominal transaksi!'); return; }

  transaksi.push({ tanggal, jenis, kategori, nominal });
  updateTampilan();
  
  document.getElementById('nominal').value = '';
  document.getElementById('kategori').value = '';
}

function updateTampilan() {
  const riwayatTabel = document.getElementById('riwayat');
  riwayatTabel.innerHTML = '';

  let totalPemasukan = 0;
  let totalPengeluaran = 0;
  const persentase = parseFloat(document.getElementById('persentase').value) / 100;

  transaksi.forEach(t => {
    if (t.jenis === 'pemasukan') totalPemasukan += t.nominal;
    else totalPengeluaran += t.nominal;

    riwayatTabel.innerHTML += `<tr>
      <td>${t.tanggal}</td>
      <td>${t.jenis}</td>
      <td>${t.kategori}</td>
      <td>Rp ${t.nominal}</td>
    </tr>`;
  });

  const saldo = totalPemasukan - totalPengeluaran;
  const tabungan = saldo * persentase;

  document.getElementById('totalPemasukan').innerText = totalPemasukan;
  document.getElementById('totalPengeluaran').innerText = totalPengeluaran;
  document.getElementById('saldo').innerText = saldo;
  document.getElementById('modal').innerText = tabungan;

  updateRekapMingguan();
}

function updateRekapMingguan() {
  const rekap = {};
  transaksi.forEach(t => {
    const date = new Date(t.tanggal);
    const day = date.getDay(); // 0 = Minggu, 1 = Senin
    const startOfWeek = new Date(date);
    startOfWeek.setDate(date.getDate() - day + 1); // Senin sebagai awal minggu
    const weekKey = startOfWeek.toISOString().split('T')[0];

    if (!rekap[weekKey]) rekap[weekKey] = { pemasukan: 0, pengeluaran: 0 };

    if (t.jenis === 'pemasukan') rekap[weekKey].pemasukan += t.nominal;
    else rekap[weekKey].pengeluaran += t.nominal;
  });

  const rekapTabel = document.getElementById('rekapMingguan');
  rekapTabel.innerHTML = '';

  const persentase = parseFloat(document.getElementById('persentase').value) / 100;

  for (let key in rekap) {
    const saldo = rekap[key].pemasukan - rekap[key].pengeluaran;
    const tabungan = saldo * persentase;
    rekapTabel.innerHTML += `<tr>
      <td>${key}</td>
      <td>Rp ${rekap[key].pemasukan}</td>
      <td>Rp ${rekap[key].pengeluaran}</td>
      <td>Rp ${saldo}</td>
      <td>Rp ${tabungan}</td>
    </tr>`;
  }
}
</script>
</body>
</html>
