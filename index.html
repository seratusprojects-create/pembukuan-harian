<!DOCTYPE html><html lang="id">
<head>
  <link rel="manifest" href="manifest.json">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Manajemen Keuangan Harian</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
  <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
  </script>
<body class="bg-gray-100 min-h-screen p-6">  <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow p-6">
    <h1 class="text-2xl font-bold text-center mb-6">ðŸ“Š Manajemen Keuangan</h1><!-- Summary -->
<div class="grid grid-cols-3 gap-4 text-center mb-6">
  <div class="bg-green-100 p-4 rounded-xl">
    <p class="text-sm">Pemasukan</p>
    <p id="incomeTotal" class="font-bold text-green-600">Rp0</p>
  </div>
  <div class="bg-red-100 p-4 rounded-xl">
    <p class="text-sm">Pengeluaran</p>
    <p id="expenseTotal" class="font-bold text-red-600">Rp0</p>
  </div>
  <div class="bg-blue-100 p-4 rounded-xl">
    <p class="text-sm">Tabungan</p>
    <p id="savingTotal" class="font-bold text-blue-600">Rp0</p>
  </div>
</div>

<!-- Form -->
<div class="space-y-4">
  <input id="desc" type="text" placeholder="Keterangan" class="w-full p-3 border rounded-xl" />
  <input id="amount" type="number" placeholder="Jumlah (Rp)" class="w-full p-3 border rounded-xl" />
  <select id="type" class="w-full p-3 border rounded-xl">
    <option value="income">Pemasukan</option>
    <option value="expense">Pengeluaran</option>
    <option value="saving">Tabungan</option>
  </select>
  <button onclick="addData()" class="w-full bg-black text-white py-3 rounded-xl">Tambah</button>
</div>

<!-- List -->
<ul id="list" class="mt-6 space-y-2"></ul>

  </div><script>
  let data = JSON.parse(localStorage.getItem('finance')) || [];

  function formatRupiah(num) {
    return 'Rp' + num.toLocaleString('id-ID');
  }

  function render() {
    let income = 0, expense = 0, saving = 0;
    const list = document.getElementById('list');
    list.innerHTML = '';

    data.forEach(item => {
      if (item.type === 'income') income += item.amount;
      if (item.type === 'expense') expense += item.amount;
      if (item.type === 'saving') saving += item.amount;

      const li = document.createElement('li');
      li.className = 'flex justify-between bg-gray-50 p-3 rounded-xl text-sm';
      li.innerHTML = `<span>${item.desc}</span><span>${formatRupiah(item.amount)}</span>`;
      list.appendChild(li);
    });

    document.getElementById('incomeTotal').innerText = formatRupiah(income);
    document.getElementById('expenseTotal').innerText = formatRupiah(expense);
    document.getElementById('savingTotal').innerText = formatRupiah(saving);

    localStorage.setItem('finance', JSON.stringify(data));
  }

  function addData() {
    const desc = document.getElementById('desc').value;
    const amount = Number(document.getElementById('amount').value);
    const type = document.getElementById('type').value;

    if (!desc || !amount) return alert('Lengkapi data');

    data.push({ desc, amount, type });
    render();

    document.getElementById('desc').value = '';
    document.getElementById('amount').value = '';
  }

  render();
</script></body>
</html>
<h3>Ringkasan Harian</h3>
<p>Total Pemasukan: Rp <span id="totalPemasukan">0</span></p>
<p>Total Pengeluaran: Rp <span id="totalPengeluaran">0</span></p>
<p>Saldo Hari Ini: Rp <span id="saldo">0</span></p>
<p>Tabungan (persentase): Rp <span id="modal">0</span></p>

<h3>Riwayat Transaksi Harian</h3>
<table>
  <thead>
    <tr>
      <th>Tanggal</th>
      <th>Jenis</th>
      <th>Kategori</th>
      <th>Nominal</th>
    </tr>
  </thead>
  <tbody id="riwayat">
  </tbody>
</table>

<h3>Rekap Mingguan</h3>
<table>
  <thead>
    <tr>
      <th>Minggu Mulai</th>
      <th>Total Pemasukan</th>
      <th>Total Pengeluaran</th>
      <th>Saldo</th>
      <th>Tabungan</th>
    </tr>
  </thead>
  <tbody id="rekapMingguan">
  </tbody>
</table>

<script>
let transaksi = [];

function tambahTransaksi() {
  const tanggal = document.getElementById('tanggal').value;
  const jenis = document.getElementById('jenis').value;
  const kategori = document.getElementById('kategori').value || '-';
  const nominal = parseInt(document.getElementById('nominal').value);
  const persentase = parseFloat(document.getElementById('persentase').value) / 100;

  if (!tanggal) { alert('Masukkan tanggal!'); return; }
  if (!nominal) { alert('Masukkan nominal transaksi!'); return; }

  transaksi.push({ tanggal, jenis, kategori, nominal });
  updateTampilan();
  
  document.getElementById('nominal').value = '';
  document.getElementById('kategori').value = '';
}

function updateTampilan() {
  const riwayatTabel = document.getElementById('riwayat');
  riwayatTabel.innerHTML = '';

  let totalPemasukan = 0;
  let totalPengeluaran = 0;
  const persentase = parseFloat(document.getElementById('persentase').value) / 100;

  transaksi.forEach(t => {
    if (t.jenis === 'pemasukan') totalPemasukan += t.nominal;
    else totalPengeluaran += t.nominal;

    riwayatTabel.innerHTML += `<tr>
      <td>${t.tanggal}</td>
      <td>${t.jenis}</td>
      <td>${t.kategori}</td>
      <td>Rp ${t.nominal}</td>
    </tr>`;
  });

  const saldo = totalPemasukan - totalPengeluaran;
  const tabungan = saldo * persentase;

  document.getElementById('totalPemasukan').innerText = totalPemasukan;
  document.getElementById('totalPengeluaran').innerText = totalPengeluaran;
  document.getElementById('saldo').innerText = saldo;
  document.getElementById('modal').innerText = tabungan;

  updateRekapMingguan();
}

function updateRekapMingguan() {
  const rekap = {};
  transaksi.forEach(t => {
    const date = new Date(t.tanggal);
    const day = date.getDay(); // 0 = Minggu, 1 = Senin
    const startOfWeek = new Date(date);
    startOfWeek.setDate(date.getDate() - day + 1); // Senin sebagai awal minggu
    const weekKey = startOfWeek.toISOString().split('T')[0];

    if (!rekap[weekKey]) rekap[weekKey] = { pemasukan: 0, pengeluaran: 0 };

    if (t.jenis === 'pemasukan') rekap[weekKey].pemasukan += t.nominal;
    else rekap[weekKey].pengeluaran += t.nominal;
  });

  const rekapTabel = document.getElementById('rekapMingguan');
  rekapTabel.innerHTML = '';

  const persentase = parseFloat(document.getElementById('persentase').value) / 100;

  for (let key in rekap) {
    const saldo = rekap[key].pemasukan - rekap[key].pengeluaran;
    const tabungan = saldo * persentase;
    rekapTabel.innerHTML += `<tr>
      <td>${key}</td>
      <td>Rp ${rekap[key].pemasukan}</td>
      <td>Rp ${rekap[key].pengeluaran}</td>
      <td>Rp ${saldo}</td>
      <td>Rp ${tabungan}</td>
    </tr>`;
  }
}
</script>
</body>
</html>
